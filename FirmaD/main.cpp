#include <iostream>
#include <NTL/ZZ.h>
#include <string>
#include "Firma.h"

using namespace std;
using namespace NTL;

/******************************************************************************************************/
        string zztostring(const ZZ &z){
            stringstream buffer;
            buffer << z;
            return buffer.str();
        }
/******************************************************************************************************/
        ZZ strtozz(string p){
            char oracion[1000];
            strcpy(oracion,p.c_str());
            return conv<ZZ>(oracion);
        }
/******************************************************************************************************/


int main()
{
    ZZ d,e,n,m,p_E,p_N,zero(0);

/*****   GENERAR CLAVES   *****************************/
/*  P: 12923  Q:7867
    Clave Privada: 95856301,101665241
    Clave Publica: 81906661,101665241
*/

    Firma r1(64);

/******************************************************/
/*****   CIFRADO   ************************************/
/******************************************************/
    string _e = "6526810104037690252429492578417248081651044063941470705858286494513659358783936305292845230926734244045224363033391543220561236461084212791173109486117415222282277976824039369014620106961201521987513452656116041684062073911268970703002293339271844062381993831767544791422012026704193107396012325283309233197";
    string _d = "5958348532160201952167073441758798098108778699112115881709664795532140458579093444906607529143658543745788896243973556838041719220339527147872467620667951721933962274108493839694828786480514078319367466953913227870112031633517768723379246020160985184877030130972796442528035668001552328184370882477332658533";
    string _n = "11983962576241373997272957432053015832425352080025626038717081038504231745742936968165221459423313643919701007325627290264349310400771919524263430384185370515205487397251342083574031537494889070882346122380375037932318782940642438148903331804334852707302340966369619779652970778128467619108336327783740970231";

    string p_e = "39511270258975445040233624151726720609910873557299646477440029428394315998456386275036417946715278922126095414696212242342547212545467734361876130410894014447485874259284801065044482333019168905001237795115129972281106107898238361762275077925026680183835637947286080368069187406452213535027686495724305947262";
    string p_n = "105285751823390061875979382915205249362733766787244689986643198687684371298481817753327268698612465407343611917544459304238295859772094365732764977379544789584905004105714017469905765397205782830153700366344799560418592319330807610510953740520923594357452548268730444556151695988077349001504429276808992627397";

    e = strtozz(_e);
    d = strtozz(_d);
    n = strtozz(_n);
    p_E = strtozz(p_e);
    p_N = strtozz(p_n);

    Firma r2(e,d,n,p_E,p_N);
    r2.cifrado("BOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJABOBESPONJA");

/******************************************************/
/********   DECIFRADO   *******************************/
/******************************************************/


    _e = "6639379";
    _d = "185120555";
    _n = "365416591";

    p_e = "21174682666858216291408216908393971241209471428238174847820146589072688237816274475036370468091173077024796358966458632581208327664607617638505034602783967952417566697747134445511826113532917091865802181383646431781002821417163937367065680561375113526747417125304556525366839221878222230257439432321264656997";
    p_n = "19626465252665904849881001490899058160054553018724936319390892603664651697389788097815379605551675260956027784797352367984109833054669561418547355970004961595411248598888957845750429887664371466362211847168951685699176108950664603425887807226605317411470857834366344575277818694942101112326439446139139428743275253261922009621447303800848596007626468473787602960459613780599413705530044053576333067501330168472064580330266317654545878288600331045648847124827681780071012334031011303424320235255501310709881206633921705367219140832749738205810036855465194658477809615645816244753385639815865175621852908899164383738637";


    string _m = "093972072432740396087999136768388693484656485543055755162158752831517512591431229439308063799987793628296646749361042963903597368990374757278503588892492721763676241952642294389481582367983122637084955220839185745997607330028239301799347293897194182320288335666053965800394282783309809492235127274011901039219052725845380777490247089113595855562359090631397806064732846171887144404280130085041657595852224537815741200734664922340166361923990666262977284677101759715051651333550839326540465699085385730896667053119653306667723126133136352098328467161905632948466826575480578978344884124763480194257749931943072881038210009615530056247876944737894791580772728447991931023351375414594038191779900105407770600789221786424400196254078125349860953675076441118386805604123447563810944935916659883913048142092530798425358737440238776584481557795118780333415157604639150970269231290639165443423372438284539897905220803436953913279095746091746997629120597564231903874665934393170405611816192946497413577290673597896572153230929937304217726468482653304583973069108142483049155267985478993600373399036963079217692600494427936410027188559207442365031868307942071942393543027951949000026761277334052495405274214186358039891188290311245778318958237393";


    e = strtozz(_e);
    d = strtozz(_d);
    n = strtozz(_n);
    p_E = strtozz(p_e);
    p_N = strtozz(p_n);

    Firma r3(e,d,n,p_E,p_N);
    r3.decifrado(_m);

    return 0;
}
